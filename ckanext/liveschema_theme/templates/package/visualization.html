{% extends "package/read_base.html" %}

{% block subtitle %}{{ _('Visualization') }} - {{ super() }}{% endblock %}

{% block secondary %}{% endblock %}

{% block primary %}
  <article class="module">
    <header class="module-content page-header">
      {# As copied from package/read_base.html  #}
      <div class="content_action">
        {% block content_action %}
          {% if not is_activity_archive %}
            {% if h.check_access('package_update', {'id':pkg.id }) %}
              {% link_for _('Manage'), named_route='dataset.edit', id=pkg.name, class_='btn btn-default', icon='wrench' %}
            {% endif %}
          {% endif %}
        {% endblock %}
      </div>
      <ul class="nav nav-tabs">
        {{ h.build_nav_icon('dataset_read', _('Dataset'), id=pkg.name) }}
        {{ h.build_nav_icon('ckanext_liveschema_theme_fca', _('FCA'), id=pkg.name) }}
        {{ h.build_nav_icon('ckanext_liveschema_theme_cue', _('Cue'), id=pkg.name) }}
        {{ h.build_nav_icon('ckanext_liveschema_theme_visualization', _('Visualization'), id=pkg.name) }}
        {{ h.build_nav_icon('ckanext_liveschema_theme_graph', _('Graph'), id=pkg.name) }}
        {{ h.build_nav_icon('ckanext_liveschema_theme_query', _('Query'), id=pkg.name) }}
        {{ h.build_nav_icon('dataset_activity', _('Activities'), id=pkg.name) }}
      </ul>
    </header>
    <div class="module-content">
      <h1 class="hide-heading">{{ _('Visualization') }}</h1>
      <header>
        <div class="row">
          <div class="col-xs-9">
            <h1>Visualization input generated by the <a href="/service/visualization_generator/{{ pkg.name }}">Visualization Generator</a></h1>
          </div>
          <div class="col-xs-3">
            {% if FCAResource %}
              <form action="/dataset/visualization/{{ pkg.name }}" method="post" target="_blank">
                <button class="btn btn-info btn-lg" style="display: block; margin-left: auto;">Knowledge Lotus</button>
              </form>
            {% endif %}
          </div> 
        </div>
      </header>
        <ul class="{% block resource_list_class %}resource-list{% endblock %}">
          {% snippet 'package/snippets/resource_item.html', res=visualizationResource, pkg=pkg, can_edit=can_edit %}
        </ul>
        Make sure you download the resource
        <br />
        Then upload it to the frame below
        <br />
        Move to the related Settings tab
        <br />
        Have fun playing with the visualization
        <iframe src="https://asntech.shinyapps.io/intervene" style="width: 100%;height: 1000px;"></iframe>
    </div>
  </article>
{% endblock %}
