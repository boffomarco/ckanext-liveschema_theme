<h3>Select a DataSet: </h3>
<form action="/test.py" method="post">
    <div class="row">
        <div class="col-sm-4">
            <select id="select_2" name="dataset" style="width:100%"  onclick="loadDoc()" >
                <option value="Dataset">DataSet Selection</option>
            </select>
        </div>
    </div>
    <br />
    <div class="row">
        <div class="col-sm-4">
            <input type="submit" class="btn btn-primary btn-block" value="List Generate FCA ">
        </div>
    </div>
</form>

<script>
    function loadDoc() {
        if(document.getElementById("select_2").length == 1){
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {

                    var myObj = JSON.parse(this.responseText);
                    tmp = "";
                    for (var i=0; i<myObj["result"].length; i++) {
                        //tmp = tmp + "<option value='a'>"+myObj["result"][i]+"</option>\n";
                        var xhttp_ = new XMLHttpRequest();
                        xhttp_.onreadystatechange = function() {
                            if (this.readyState == 4 && this.status == 200) {

                                var myObj_ = JSON.parse(this.responseText);
                                tmp = tmp + "<option value='"+myObj_["result"]["name"]+"'>"+myObj_["result"]["title"]+"</option>\n";
                                document.getElementById("select_2").innerHTML = tmp;
                            }

                        };
                        xhttp_.open("GET", "http://127.0.0.1:5000/api/3/action/package_show?id="+myObj["result"][i], true);
                        xhttp_.send();
                    }
                    
                    document.getElementById("select_2").innerHTML = tmp;
                }

            };
            xhttp.open("GET", "http://127.0.0.1:5000/api/3/action/package_list", true);
            xhttp.send();

            $("#select_2").select2();
        }
    }
</script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.10/css/select2.min.css" rel="stylesheet" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.10/js/select2.min.js"></script>
